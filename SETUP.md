# Инструкция по настройке AbuCargo

## Создание первого администратора

После развертывания системы вам нужно создать первого администратора:

### Способ 1: Через специальную страницу (Рекомендуется)

1. Перейдите на страницу `/admin/create` (например: `https://ваш-домен.com/admin/create`)
2. Заполните форму:
   - Имя и фамилия
   - Номер телефона: `+996558105551`
   - Пароль: `admin123`
   - Выберите ПВЗ
   - Выберите роль: Администратор
3. Нажмите "Создать"

### Способ 2: Через SQL в базе данных

Если вам нужно создать администратора напрямую в базе данных:

```sql
-- 1. Сначала создайте пользователя через регистрацию на сайте
-- или выполните следующие SQL команды:

-- 2. Найдите user_id созданного пользователя
SELECT user_id, full_name FROM profiles WHERE phone = '+996558105551';

-- 3. Обновите роль пользователя на admin
UPDATE user_roles 
SET role = 'admin' 
WHERE user_id = 'user_id_из_предыдущего_запроса';
```

## Настройка системы

### 1. Цена за килограмм

По умолчанию установлена цена 12 сом/кг. Изменить можно:
- В админ-панели: **Приём посылок** → раздел "Настройка цены"
- В базе данных: таблица `settings`

### 2. Логотип

Логотип находится в `/src/assets/logo.jpg`. Для замены:
- Замените файл `logo.jpg` в папке `src/assets/`
- Или загрузите через настройки (функция в разработке)

### 3. ПВЗ (Пункты выдачи заказов)

Текущие ПВЗ и их коды:
- **Нариман** → `YQ` (YQ1, YQ2, YQ3...)
- **Жийдалик УПТК** → `YX` (YX1, YX2, YX3...)
- **Достук** → `JL` (JL1, JL2, JL3...)

Коды генерируются автоматически при регистрации пользователя.

## Роли пользователей

### Admin (Администратор)
- Полный доступ ко всем функциям
- Управление пользователями
- Загрузка посылок из Excel
- Просмотр всех посылок
- Управление настройками

### PVZ (Админ ПВЗ)
- Просмотр посылок своего ПВЗ
- Обновление статусов посылок
- Просмотр клиентов своего ПВЗ

### User (Пользователь)
- Просмотр своих посылок
- Добавление трек-кодов
- Просмотр адреса для отправки
- Редактирование профиля

## Работа с посылками

### Для пользователей

1. **Добавление трек-кода:**
   - Перейдите в раздел "Мои посылки"
   - Введите трек-код в поле "Добавить трек-код"
   - Нажмите "Добавить"
   - Посылка получит статус "Ожидает поступления"

2. **Отслеживание:**
   - Статус автоматически обновится, когда админ загрузит Excel с данными
   - Вес и стоимость появятся после загрузки данных

### Для администраторов

1. **Загрузка Excel файла:**
   - Перейдите в "Приём посылок"
   - Загрузите Excel файл (.xlsx или .xls)
   - Выберите столбцы:
     - Трек-коды
     - Вес
     - Дата отправки
   - Нажмите "Опубликовать"

2. **Автоматическое сопоставление:**
   - Система автоматически найдет пользователей по трек-кодам
   - Если пользователь добавил трек-код в "Мои посылки", он будет автоматически связан
   - Статус изменится на "В пути"
   - Рассчитается стоимость: вес × цена_за_кг

3. **Обновление статусов:**
   - В разделе "В дороге" можно вручную изменить статус любой посылки
   - Доступные статусы:
     - Ожидает поступления
     - В пути
     - Прибыл
     - Выдан

## Адрес склада в Китае

Каждый пользователь получает уникальный адрес для отправки:

```
{Китайское_название_компании}{КОД_КЛИЕНТА}
{Телефон}
浙江省金华市义乌市北苑街道春晗二区36栋好运国际货运5697库
入仓号:{Китайское_название_компании}{КОД_КЛИЕНТА}
```

Где китайское название зависит от ПВЗ:
- YQ → 优祺
- YX → 御玺
- JL → 佳联

## Часто задаваемые вопросы

**Q: Как изменить цену за килограмм?**
A: Перейдите в "Приём посылок" → "Настройка цены" → введите новую цену → "Сохранить"

**Q: Что делать, если пользователь не привязался к посылке?**
A: Убедитесь, что пользователь добавил точный трек-код в "Мои посылки" ДО загрузки Excel

**Q: Можно ли добавить новое ПВЗ?**
A: Да, но требуется изменение кода. Обратитесь к разработчику.

**Q: Как удалить пользователя?**
A: Перейдите в "Пользователи" → найдите пользователя → кнопка удаления (корзина)

## Поддержка

При возникновении проблем проверьте:
1. Логи браузера (F12 → Console)
2. Правильность формата Excel файла
3. Корректность трек-кодов

---

**Версия:** 1.0  
**Дата:** Апрель 2025
